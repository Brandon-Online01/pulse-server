{{#> base headerTitle="Your Daily Activity Report" headerSubtitle="Personal performance summary for {{date}}"}}

<div class="greeting">
    Hello {{name}}! üìä
</div>

<div class="message">
    <p>Here's your comprehensive daily activity summary for {{date}}. This report highlights your accomplishments, progress, and target achievements.</p>
</div>

{{#if metrics.attendance.status}}
<div class="success-notice">
    <p>‚è∞ <strong>Work Summary:</strong> You worked {{metrics.attendance.duration}} today{{#if metrics.attendance.startTime}} ({{metrics.attendance.startTime}} - {{#if metrics.attendance.endTime}}{{metrics.attendance.endTime}}{{else}}Currently Working{{/if}}){{/if}}!</p>
</div>
{{/if}}

<!-- Core Metrics Section -->
<div class="info-card">
    <h3>üìà Today's Performance</h3>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Tasks Completed</span>
            <span class="detail-value">{{metrics.userSpecific.todayTasks}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Hours Worked</span>
            <span class="detail-value">{{metrics.userSpecific.hoursWorked}}h</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">New Leads</span>
            <span class="detail-value">{{metrics.userSpecific.todayLeads}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Quotations Created</span>
            <span class="detail-value">{{metrics.userSpecific.todayQuotations}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Revenue Generated</span>
            <span class="detail-value">{{metrics.totalRevenue}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Claims Processed</span>
            <span class="detail-value">{{metrics.userSpecific.todayClaims}}</span>
        </div>
    </div>
</div>

<!-- XP and Leaderboard Section -->
{{#if metrics.userSpecific.xpEarned}}
<div class="info-card">
    <h4>üèÜ Experience & Rank</h4>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">XP Earned Today</span>
            <span class="detail-value">+{{metrics.userSpecific.xpEarned}} XP</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Current Level</span>
            <span class="detail-value">Level {{metrics.userSpecific.currentLevel}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Current Rank</span>
            <span class="detail-value">{{metrics.userSpecific.currentRank}}</span>
        </div>
    </div>
</div>
{{/if}}

<!-- Targets Progress Section -->
{{#if metrics.targets.hasTargets}}
<div class="info-card">
    <h4>üéØ Target Progress ({{metrics.targets.targetPeriod}})</h4>
    <div class="detail-grid">
        {{#if metrics.targets.salesTarget}}
        <div class="detail-item">
            <span class="detail-label">Sales Progress</span>
            <span class="detail-value">{{metrics.targets.salesTarget.formatted}} / {{metrics.targets.salesTarget.targetFormatted}} ({{metrics.targets.targetProgress.sales.progress}}%)</span>
        </div>
        {{/if}}
        {{#if metrics.targets.hoursTarget}}
        <div class="detail-item">
            <span class="detail-label">Hours Progress</span>
            <span class="detail-value">{{metrics.targets.hoursTarget.current}}h / {{metrics.targets.hoursTarget.target}}h ({{metrics.targets.targetProgress.hours.progress}}%)</span>
        </div>
        {{/if}}
        {{#if metrics.targets.leadsTarget}}
        <div class="detail-item">
            <span class="detail-label">Leads Progress</span>
            <span class="detail-value">{{metrics.targets.leadsTarget.current}} / {{metrics.targets.leadsTarget.target}} ({{metrics.targets.targetProgress.leads.progress}}%)</span>
        </div>
        {{/if}}
        {{#if metrics.targets.clientsTarget}}
        <div class="detail-item">
            <span class="detail-label">New Clients Progress</span>
            <span class="detail-value">{{metrics.targets.clientsTarget.current}} / {{metrics.targets.clientsTarget.target}} ({{metrics.targets.targetProgress.clients.progress}}%)</span>
        </div>
        {{/if}}
        {{#if metrics.targets.checkInsTarget}}
        <div class="detail-item">
            <span class="detail-label">Check-ins Progress</span>
            <span class="detail-value">{{metrics.targets.checkInsTarget.current}} / {{metrics.targets.checkInsTarget.target}} ({{metrics.targets.targetProgress.checkIns.progress}}%)</span>
        </div>
        {{/if}}
    </div>
</div>
{{/if}}

<!-- Attendance Details -->
{{#if metrics.attendance.startTime}}
<div class="info-card">
    <h4>‚è∞ Attendance Details</h4>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Status</span>
            <span class="detail-value">{{metrics.attendance.status}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Start Time</span>
            <span class="detail-value">{{metrics.attendance.startTime}}</span>
        </div>
        {{#if metrics.attendance.endTime}}
        <div class="detail-item">
            <span class="detail-label">End Time</span>
            <span class="detail-value">{{metrics.attendance.endTime}}</span>
        </div>
        {{/if}}
        <div class="detail-item">
            <span class="detail-label">Total Duration</span>
            <span class="detail-value">{{metrics.attendance.duration}}</span>
        </div>
    </div>
    {{#if metrics.attendance.checkInLocation}}
    <p><strong>Check-in Location:</strong> {{metrics.attendance.checkInLocation.latitude}}, {{metrics.attendance.checkInLocation.longitude}}</p>
    {{/if}}
</div>
{{/if}}

<!-- Growth Metrics -->
<div class="info-card">
    <h4>üìä Growth vs Yesterday</h4>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Quotations Growth</span>
            <span class="detail-value">{{metrics.quotationGrowth}} {{#if (startsWith metrics.quotationGrowth "+")}}üìà{{else}}{{#unless (eq metrics.quotationGrowth "0%")}}üìâ{{else}}‚û°Ô∏è{{/unless}}{{/if}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Revenue Growth</span>
            <span class="detail-value">{{metrics.revenueGrowth}} {{#if (startsWith metrics.revenueGrowth "+")}}üìà{{else}}{{#unless (eq metrics.revenueGrowth "0%")}}üìâ{{else}}‚û°Ô∏è{{/unless}}{{/if}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Customer Growth</span>
            <span class="detail-value">{{metrics.customerGrowth}} {{#if (startsWith metrics.customerGrowth "+")}}üìà{{else}}{{#unless (eq metrics.customerGrowth "0%")}}üìâ{{else}}‚û°Ô∏è{{/unless}}{{/if}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">New Customers</span>
            <span class="detail-value">{{metrics.newCustomers}}</span>
        </div>
    </div>
</div>

<!-- Tracking Summary -->
{{#if tracking.totalDistance}}
<div class="info-card">
    <h4>üó∫Ô∏è Location & Travel</h4>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Total Distance</span>
            <span class="detail-value">{{tracking.totalDistance}}</span>
        </div>
                 <div class="detail-item">
             <span class="detail-label">Locations Visited</span>
             <span class="detail-value">{{length tracking.locations}}</span>
         </div>
        <div class="detail-item">
            <span class="detail-label">Avg Time Per Location</span>
            <span class="detail-value">{{tracking.averageTimePerLocation}}</span>
        </div>
    </div>
    {{#if tracking.locations}}
    <div style="margin-top: 15px;">
        <strong>Key Locations:</strong>
        <ul style="margin-top: 5px; margin-left: 20px;">
            {{#each tracking.locations}}
            {{#if @index < 5}}
            <li>{{address}} - {{timeSpent}}</li>
            {{/if}}
            {{/each}}
        </ul>
    </div>
    {{/if}}
</div>
{{/if}}

<div class="cta-section">
    <a href="{{dashboardUrl}}" class="cta-button">View Full Dashboard</a>
</div>

<!-- Performance Tips -->
<div class="info-card">
    <h4>üí° Performance Insights</h4>
    <ul class="feature-list">
        {{#if (gt metrics.userSpecific.xpEarned 50)}}
        <li><strong>Great XP Day!</strong> You earned {{metrics.userSpecific.xpEarned}} XP today - keep up the momentum!</li>
        {{/if}}
        {{#if (gt metrics.userSpecific.todayQuotations 0)}}
        <li><strong>Sales Activity:</strong> {{metrics.userSpecific.todayQuotations}} quotation{{#if (gt metrics.userSpecific.todayQuotations 1)}}s{{/if}} created worth {{metrics.totalRevenue}}</li>
        {{/if}}
        {{#if (gt metrics.userSpecific.todayLeads 0)}}
        <li><strong>Lead Generation:</strong> Added {{metrics.userSpecific.todayLeads}} new lead{{#if (gt metrics.userSpecific.todayLeads 1)}}s{{/if}} to your pipeline</li>
        {{/if}}
        {{#if (gt metrics.userSpecific.hoursWorked 8)}}
        <li><strong>Dedication:</strong> You worked {{metrics.userSpecific.hoursWorked}} hours today - excellent commitment!</li>
        {{/if}}
                 {{#if tracking.totalDistance}}
         <li><strong>Field Work:</strong> Covered {{tracking.totalDistance}} visiting customers and prospects</li>
         {{/if}}
    </ul>
</div>

<!-- Quick Actions -->
<div class="info-card">
    <h4>üöÄ Tomorrow's Focus</h4>
    <ul class="feature-list">
        <li><strong>Review Pipeline:</strong> Check your leads and follow up on active prospects</li>
        <li><strong>Target Progress:</strong> Focus on areas where you can improve target achievement</li>
        <li><strong>Task Planning:</strong> Plan tomorrow's priorities based on deadlines and importance</li>
        {{#if (lt metrics.userSpecific.xpEarned 30)}}
        <li><strong>Boost XP:</strong> Complete more tasks and activities to earn additional experience points</li>
        {{/if}}
        {{#if metrics.targets.hasTargets}}
        {{#if (lt metrics.targets.targetProgress.sales.progress 50)}}
        <li><strong>Sales Focus:</strong> Your sales target needs attention - consider more quotation activities</li>
        {{/if}}
        {{/if}}
    </ul>
</div>

<div class="success-notice">
    <p>üåü <strong>Excellent Work Today!</strong> Your consistent effort contributes to team success. {{#if metrics.userSpecific.currentRank}}You're currently ranked as {{metrics.userSpecific.currentRank}} {{#if metrics.userSpecific.currentLevel}}at Level {{metrics.userSpecific.currentLevel}}{{/if}}!{{/if}}</p>
</div>

{{/base}}