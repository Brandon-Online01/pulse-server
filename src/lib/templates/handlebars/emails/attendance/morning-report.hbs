{{#base headerTitle="Daily Attendance Morning Report" headerSubtitle="Comprehensive attendance overview for {{reportDate}}"}}

<div class="greeting">
    Good morning {{recipientName}}! ‚è∞
</div>

<div class="message">
    <p>Here's your comprehensive daily attendance overview for <strong>{{reportDate}}</strong>. This report provides detailed employee attendance status and punctuality insights as of 30 minutes after the standard start time ({{organizationStartTime}}).</p>
</div>

<!-- Attendance Overview Summary -->
<div class="info-card">
    <h3>üìä Attendance Overview</h3>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Total Employees</span>
            <span class="detail-value" style="font-weight: 700; color: #7c2d92; font-size: 17px;">{{summary.totalEmployees}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Present Today</span>
            <span class="detail-value" style="font-weight: 700; color: #22c55e; font-size: 17px;">{{summary.presentCount}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Absent Today</span>
            <span class="detail-value" style="font-weight: 700; color: #ef4444; font-size: 17px;">{{summary.absentCount}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Attendance Rate</span>
            <span class="detail-value" style="font-weight: 700; font-size: 18px; color: {{#if (gte summary.attendanceRate 90)}}#22c55e{{else if (gte summary.attendanceRate 75)}}#f59e0b{{else}}#ef4444{{/if}};">{{summary.attendanceRate}}%</span>
        </div>
    </div>
</div>

<!-- Punctuality Performance -->
<div class="info-card">
    <h3>üïê Punctuality Performance</h3>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Early Arrivals</span>
            <span class="detail-value" style="color: #22c55e; font-weight: 700; font-size: 16px;">{{punctuality.earlyArrivals.length}} employees</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">On Time</span>
            <span class="detail-value" style="color: #0ea5e9; font-weight: 700; font-size: 16px;">{{punctuality.onTimeArrivals.length}} employees</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Late Arrivals</span>
            <span class="detail-value" style="color: #ef4444; font-weight: 700; font-size: 16px;">{{punctuality.lateArrivals.length}} employees</span>
        </div>
        {{#if punctuality.veryLateArrivals}}
        <div class="detail-item">
            <span class="detail-label">Very Late (30+ min)</span>
            <span class="detail-value" style="color: #991b1b; font-weight: 700; font-size: 16px;">{{punctuality.veryLateArrivals.length}} employees</span>
        </div>
        {{/if}}
        <div class="detail-item">
            <span class="detail-label">Punctuality Rate</span>
            <span class="detail-value" style="font-weight: 700; font-size: 18px; color: {{#if (gte punctuality.onTimePercentage 90)}}#22c55e{{else if (gte punctuality.onTimePercentage 75)}}#f59e0b{{else}}#ef4444{{/if}};">{{punctuality.onTimePercentage}}%</span>
        </div>
    </div>
</div>

<!-- Early Arrivals Recognition -->
{{#if punctuality.earlyArrivals}}
<div class="success-notice">
    <h4 style="color: #15803d; margin-bottom: 16px;">üåÖ Early Arrivals - Outstanding Dedication ({{punctuality.earlyArrivals.length}})</h4>
    <div style="display: grid; gap: 12px;">
        {{#each punctuality.earlyArrivals}}
        <div style="display: flex; align-items: center; padding: 16px; background: rgba(34, 197, 94, 0.1); border-radius: 12px; border-left: 4px solid #22c55e;">
            <div style="flex: 1;">
                <div style="font-weight: 700; color: #15803d; font-size: 15px;">{{name}} {{surname}}</div>
                <div style="font-size: 14px; color: #16a34a; margin-top: 2px;">{{role}}{{#if branch.name}} ‚Ä¢ {{branch.name}}{{/if}}</div>
            </div>
            <div style="text-align: right;">
                <div style="font-weight: 700; color: #15803d; font-size: 16px;">{{checkInTime}}</div>
                <div style="font-size: 12px; color: #16a34a; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">{{#if earlyMinutes}}{{earlyMinutes}} min early{{else}}Perfect Timing{{/if}}</div>
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/if}}

<!-- On Time Arrivals -->
{{#if punctuality.onTimeArrivals}}
<div class="info-card" style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-left-color: #22c55e;">
    <h4 style="color: #166534;">‚úÖ On Time Arrivals - Excellent Punctuality ({{punctuality.onTimeArrivals.length}})</h4>
    <div style="display: grid; gap: 12px; margin-top: 16px;">
        {{#each punctuality.onTimeArrivals}}
        <div style="display: flex; align-items: center; padding: 16px; background: rgba(34, 197, 94, 0.05); border-radius: 12px; border-left: 3px solid #22c55e;">
            <div style="flex: 1;">
                <div style="font-weight: 700; color: #166534; font-size: 15px;">{{name}} {{surname}}</div>
                <div style="font-size: 14px; color: #16a34a; margin-top: 2px;">{{role}}{{#if branch.name}} ‚Ä¢ {{branch.name}}{{/if}}</div>
            </div>
            <div style="text-align: right;">
                <div style="font-weight: 700; color: #166534; font-size: 16px;">{{checkInTime}}</div>
                <div style="font-size: 12px; color: #16a34a; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Perfect Timing</div>
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/if}}

<!-- Late Arrivals -->
{{#if punctuality.lateArrivals}}
<div class="info-card" style="background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%); border-left-color: #ef4444;">
    <h4 style="color: #991b1b;">‚ö†Ô∏è Late Arrivals - Requires Attention ({{punctuality.lateArrivals.length}})</h4>
    <div style="display: grid; gap: 12px; margin-top: 16px;">
        {{#each punctuality.lateArrivals}}
        <div style="display: flex; align-items: center; padding: 16px; background: rgba(239, 68, 68, 0.05); border-radius: 12px; border-left: 3px solid #ef4444;">
            <div style="flex: 1;">
                <div style="font-weight: 700; color: #991b1b; font-size: 15px;">{{name}} {{surname}}</div>
                <div style="font-size: 14px; color: #dc2626; margin-top: 2px;">{{role}}{{#if branch.name}} ‚Ä¢ {{branch.name}}{{/if}}</div>
            </div>
            <div style="text-align: right;">
                <div style="font-weight: 700; color: #991b1b; font-size: 16px;">{{checkInTime}}</div>
                <div style="font-size: 12px; color: #dc2626; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">
                    {{#if lateMinutes}}{{lateMinutes}}min Delay{{else}}Late Arrival{{/if}}
                </div>
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/if}}

<!-- Very Late Arrivals - Critical section -->
{{#if punctuality.veryLateArrivals}}
<div style="background: rgba(153, 27, 27, 0.1); border: 2px solid #991b1b; border-radius: 12px; padding: 20px; margin: 20px 0;">
    <h4 style="color: #991b1b; margin-bottom: 16px; display: flex; align-items: center;">üö® CRITICAL: Very Late Arrivals ({{punctuality.veryLateArrivals.length}})</h4>
    <p style="color: #7f1d1d; font-size: 14px; margin-bottom: 16px;">These employees arrived 30+ minutes late and require immediate attention.</p>
    <div style="display: grid; gap: 12px;">
        {{#each punctuality.veryLateArrivals}}
        <div style="display: flex; align-items: center; padding: 16px; background: rgba(153, 27, 27, 0.15); border-radius: 8px; border-left: 4px solid #991b1b;">
            <div style="flex: 1;">
                <div style="font-weight: 700; color: #991b1b; font-size: 15px;">{{name}} {{surname}}</div>
                <div style="font-size: 14px; color: #7f1d1d; margin-top: 2px;">{{role}}{{#if branch.name}} ‚Ä¢ {{branch.name}}{{/if}}</div>
            </div>
            <div style="text-align: right;">
                <div style="font-weight: 700; color: #991b1b; font-size: 16px;">{{checkInTime}}</div>
                <div style="font-size: 12px; color: #7f1d1d; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">{{lateMinutes}} MINUTES LATE</div>
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/if}}

<!-- Absent Employees -->
{{#if absentEmployees}}
<div class="info-card" style="background: linear-gradient(135deg, #fafafa 0%, #f4f4f5 100%); border-left-color: #71717a;">
    <h4 style="color: #52525b;">‚ùå Absent Employees - Follow-up Needed ({{absentEmployees.length}})</h4>
    <div style="display: grid; gap: 12px; margin-top: 16px;">
        {{#each absentEmployees}}
        <div style="display: flex; align-items: center; padding: 16px; background: rgba(113, 113, 122, 0.05); border-radius: 12px; border-left: 3px solid #71717a;">
            <div style="flex: 1;">
                <div style="font-weight: 700; color: #52525b; font-size: 15px;">{{name}} {{surname}}</div>
                <div style="font-size: 14px; color: #71717a; margin-top: 2px;">{{role}}{{#if branch.name}} ‚Ä¢ {{branch.name}}{{/if}}</div>
            </div>
            <div style="text-align: right;">
                <div style="font-size: 14px; color: #71717a; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">No Check-in</div>
                <div style="font-size: 12px; color: #71717a; font-weight: 500;">Requires Contact</div>
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/if}}

<!-- Lateness Summary -->
{{#if latenessSummary.totalLateEmployees}}
<div class="warning-notice">
    <h4 style="color: #d97706; margin-bottom: 16px;">üìä Lateness Summary</h4>
    <div class="detail-grid">
        <div class="detail-item">
            <span class="detail-label">Total Late Employees</span>
            <span class="detail-value" style="color: #dc2626; font-weight: 700;">{{latenessSummary.totalLateEmployees}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Total Late Minutes</span>
            <span class="detail-value" style="color: #dc2626; font-weight: 700;">{{latenessSummary.totalLateMinutes}}</span>
        </div>
        <div class="detail-item">
            <span class="detail-label">Average Late Minutes</span>
            <span class="detail-value" style="color: #dc2626; font-weight: 700;">{{latenessSummary.averageLateMinutes}}</span>
        </div>
        {{#if latenessSummary.worstLateArrival}}
        <div class="detail-item">
            <span class="detail-label">Most Late</span>
            <span class="detail-value" style="color: #991b1b; font-weight: 700;">{{latenessSummary.worstLateArrival.employee}} ({{latenessSummary.worstLateArrival.minutes}} min)</span>
        </div>
        {{/if}}
    </div>
</div>
{{/if}}

<!-- Key Insights -->
<div class="info-card">
    <h4 style="color: #7c2d92; margin-bottom: 16px;">üí° Key Insights & Performance Highlights</h4>
    <ul style="margin-left: 20px; color: #4b5563; line-height: 1.8; font-size: 15px;">
        <li style="margin-bottom: 8px;">
            <strong style="color: #374151;">Outstanding Performance:</strong> 
            {{#if (gt punctuality.earlyArrivals.length 0)}}
                {{punctuality.earlyArrivals.length}} employees arrived early, demonstrating excellent dedication and commitment üåü
            {{else}}
                All present employees showed great punctuality arriving on time or close to schedule ‚≠ê
            {{/if}}
        </li>
        <li style="margin-bottom: 8px;">
            <strong style="color: #374151;">Attendance Health:</strong> 
            {{#if (gte summary.attendanceRate 90)}}
                Outstanding attendance rate of {{summary.attendanceRate}}% - your team is highly engaged! üéØ
            {{else if (gte summary.attendanceRate 75)}}
                Solid attendance rate of {{summary.attendanceRate}}% with opportunity for improvement üìà
            {{else}}
                Attendance rate of {{summary.attendanceRate}}% requires immediate attention and intervention üö®
            {{/if}}
        </li>
        <li style="margin-bottom: 8px;">
            <strong style="color: #374151;">Punctuality Status:</strong> 
            {{#if (gt punctuality.lateArrivals.length 0)}}
                {{punctuality.lateArrivals.length}} late arrivals today - recommend personal check-ins to address potential barriers üïê
            {{else}}
                Perfect punctuality across all attendees - exceptional team discipline! üéâ
            {{/if}}
        </li>
        {{#if (gt summary.absentCount 0)}}
        <li style="margin-bottom: 8px;">
            <strong style="color: #374151;">Wellness Check:</strong> 
            {{summary.absentCount}} employees absent - prioritize personal contact to ensure wellbeing and provide support ü§ù
        </li>
        {{/if}}
    </ul>
</div>

<!-- Action Items -->
{{#if (or (gt punctuality.lateArrivals.length 0) (gt summary.absentCount 0))}}
<div class="warning-notice">
    <p style="font-size: 16px; font-weight: 700; color: #7c2d92;">üìã Strategic Action Plan</p>
    <ul style="margin-left: 20px; margin-top: 16px; line-height: 1.8; font-size: 15px;">
        {{#if (gt punctuality.lateArrivals.length 0)}}
        <li style="margin-bottom: 8px;">
            <strong>Punctuality Support:</strong> Schedule individual conversations with late arrivals to identify barriers and provide flexible solutions
        </li>
        <li style="margin-bottom: 8px;">
            <strong>Pattern Analysis:</strong> Monitor tardiness trends over the next week to identify systemic issues vs. individual challenges
        </li>
        {{/if}}
        {{#if (gt summary.absentCount 0)}}
        <li style="margin-bottom: 8px;">
            <strong>Wellness Outreach:</strong> Contact absent employees within 2 hours to ensure safety and offer assistance if needed
        </li>
        <li style="margin-bottom: 8px;">
            <strong>Policy Review:</strong> Evaluate current attendance expectations and support systems for realistic adjustments
        </li>
        {{/if}}
        <li style="margin-bottom: 8px;">
            <strong>Recognition Program:</strong> Acknowledge early arrivals and consistent performers with personalized appreciation or team shout-outs üèÜ
        </li>
    </ul>
</div>
{{else}}
<div class="success-notice">
    <p style="font-size: 16px; font-weight: 700; color: #15803d;">üéâ Exceptional Performance Today!</p>
    <p style="margin-top: 12px; font-size: 15px; line-height: 1.6;">
        Perfect attendance and punctuality across your team. Consider celebrating this achievement and using it as momentum for continued excellence.
    </p>
</div>
{{/if}}

<!-- CTA Section -->
<div class="cta-section">
    <a href="{{dashboardUrl}}/attendance" class="cta-button">View Full Attendance Dashboard</a>
</div>

<!-- Report Footer -->
<div class="message">
    <p style="font-size: 14px; color: #6b7280; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
        <strong>Report Details:</strong><br>
        Generated: {{generatedAt}}<br>
        Organization: {{organizationName}}<br>
        Standard Start Time: {{organizationStartTime}}<br>
        Late Threshold: 5 minutes after start time
    </p>
</div>

{{/base}} 